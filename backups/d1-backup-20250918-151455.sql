PRAGMA defer_foreign_keys=TRUE;
CREATE TABLE d1_migrations(
		id         INTEGER PRIMARY KEY AUTOINCREMENT,
		name       TEXT UNIQUE,
		applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);
INSERT INTO d1_migrations VALUES(1,'0001_initial_with_users.sql','2025-08-13 14:46:37');
CREATE TABLE users (
  address TEXT PRIMARY KEY, 
  created_at TEXT DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO users VALUES('0x560EBafD8dB62cbdB44B50539d65b48072b98277','2025-08-13 14:46:56');
CREATE TABLE nonces (
  address TEXT PRIMARY KEY,
  nonce TEXT NOT NULL,
  issued_at TEXT DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO nonces VALUES('0x560ebafd8db62cbdb44b50539d65b48072b98277','5eoydn5QOF7g1nVT9','2025-08-14T00:55:31.461Z');
INSERT INTO nonces VALUES('0xc20c055881217DB8241aBD91fEdFbA5f2794CAa8','3wItlalMsADGf718B','2025-08-26T00:56:09.452Z');
INSERT INTO nonces VALUES('0x3351Cd30b5AC4AB63A5B19b246ED6cfAB6440607','jLwifkVnqU2KPfPX5','2025-08-26T00:56:11.456Z');
INSERT INTO nonces VALUES('0x578B6C5309689795cA4fE69Fc05Bb995f518317D','QzKLqq0YBusBOODph','2025-08-26T00:56:25.058Z');
CREATE TABLE headaches (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  timestamp TEXT NOT NULL, 
  severity INTEGER NOT NULL CHECK (severity BETWEEN 0 AND 10),
  aura INTEGER NOT NULL CHECK (aura IN (0,1)),
  user_id TEXT,
  FOREIGN KEY(user_id) REFERENCES users(address) ON DELETE CASCADE
);
INSERT INTO headaches VALUES(1,'2025-08-13T14:54:50.593Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(2,'2025-08-13T23:29:29.234Z',6,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(3,'2025-08-14T13:10:07.233Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(4,'2025-08-14T17:40:11.175Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(5,'2025-08-14T22:46:18.754Z',7,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(6,'2025-08-15T02:38:22.909Z',6,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(7,'2025-08-15T16:36:17.140Z',1,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(8,'2025-08-15T23:37:36.347Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(9,'2025-08-16T14:41:16.365Z',0,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(10,'2025-08-16T18:37:16.801Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(11,'2025-08-17T01:38:44.313Z',5,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(12,'2025-08-17T03:54:41.862Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(13,'2025-08-17T22:19:47.943Z',4,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(14,'2025-08-18T14:27:11.430Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(15,'2025-08-18T20:29:01.013Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(16,'2025-08-18T22:18:11.651Z',6,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(17,'2025-08-19T00:07:25.045Z',7,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(18,'2025-08-19T00:42:56.251Z',8,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(19,'2025-08-19T15:00:09.943Z',5,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(20,'2025-08-19T19:11:48.086Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(21,'2025-08-19T22:56:13.076Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(22,'2025-08-20T14:44:31.096Z',1,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(23,'2025-08-21T02:07:16.742Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(24,'2025-08-21T18:57:33.550Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(25,'2025-08-22T13:55:42.629Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(26,'2025-08-22T21:45:07.576Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(27,'2025-08-23T18:00:49.553Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(28,'2025-08-24T02:32:16.906Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(29,'2025-08-24T13:05:47.114Z',0,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(30,'2025-08-25T18:18:56.247Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(31,'2025-08-25T20:57:35.365Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(32,'2025-08-26T00:56:14.179Z',8,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(33,'2025-08-26T20:03:15.650Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(34,'2025-08-26T21:02:53.466Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(35,'2025-08-27T13:47:30.959Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(36,'2025-08-28T14:36:34.149Z',4,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(37,'2025-08-28T20:24:23.722Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(38,'2025-08-29T14:39:31.673Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(39,'2025-08-30T00:31:38.620Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(40,'2025-08-30T00:31:38.710Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(41,'2025-08-30T13:27:46.189Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(42,'2025-09-01T02:21:02.939Z',2,1,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(43,'2025-09-01T15:53:13.871Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(44,'2025-09-01T22:32:56.706Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(45,'2025-09-02T22:59:49.502Z',5,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(46,'2025-09-03T14:13:50.900Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(47,'2025-09-05T03:08:49.373Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(48,'2025-09-05T23:22:16.669Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(49,'2025-09-06T13:09:27.505Z',7,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(50,'2025-09-07T22:18:10.380Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(51,'2025-09-08T14:20:31.239Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(52,'2025-09-09T20:59:27.207Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(53,'2025-09-10T15:53:34.293Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(54,'2025-09-10T23:47:30.175Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(55,'2025-09-11T20:33:25.561Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(56,'2025-09-13T02:46:51.460Z',4,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(57,'2025-09-13T15:44:36.317Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(58,'2025-09-15T13:58:07.960Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(59,'2025-09-17T00:38:01.056Z',1,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(60,'2025-09-17T16:26:42.270Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(61,'2025-09-18T01:28:41.773Z',3,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO headaches VALUES(62,'2025-09-18T16:59:16.803Z',2,0,'0x560EBafD8dB62cbdB44B50539d65b48072b98277');
CREATE TABLE events (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  timestamp TEXT NOT NULL, 
  event_type TEXT NOT NULL, 
  value TEXT NOT NULL, 
  user_id TEXT,
  FOREIGN KEY(user_id) REFERENCES users(address) ON DELETE CASCADE
);
INSERT INTO events VALUES(1,'2025-08-13T14:55:09.298Z','project','deployed headacher to prod','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(2,'2025-08-13T23:29:46.828Z','stress','kraken xstocks deploy','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(3,'2025-08-13T23:33:10.564Z','stress','mobile web3 frustration','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(4,'2025-08-14T13:10:19.975Z','sleep','fitful, hard to wake up','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(5,'2025-08-14T17:40:30.568Z','therapy','first session with amy, I like her','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(6,'2025-08-14T22:46:44.939Z','therapy','couples therapy is hard','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(7,'2025-08-15T02:38:37.193Z','party','it was good to see my friends, but it was loud','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(8,'2025-08-15T16:36:40.071Z','stress','blockhead/fireblocks xstocks insanity','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(9,'2025-08-19T00:43:03.012Z','medication','rezatriptan','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(10,'2025-08-22T21:45:29.730Z','therapy','good conversation with amy today, but tough on me','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(11,'2025-08-22T21:45:54.163Z','family','bowie''s play performance, she''s so cute','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(12,'2025-08-26T21:03:20.195Z','therapy','allie makes me feel judged when I say anything that I don''t like','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(13,'2025-09-01T02:21:16.933Z','family','bowie didn''t want to stay here, she went back to allie''s house','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(14,'2025-09-01T22:33:12.482Z','family','bowie only wanted roblox, and then wanted to leave. she said she doesn''t like it here.','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(15,'2025-09-02T23:00:15.479Z','therapy','at the end of the session, allie offered to stop trying to reconcile','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(16,'2025-09-09T23:54:08.467Z','medication','ajovy','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
INSERT INTO events VALUES(17,'2025-09-13T02:47:09.615Z','family','bowie wanted a sleepover, but bedtime failed and I had to take her to allie''s house','0x560EBafD8dB62cbdB44B50539d65b48072b98277');
CREATE TABLE settings (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  key TEXT NOT NULL UNIQUE,
  value TEXT NOT NULL
);
DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('d1_migrations',1);
INSERT INTO sqlite_sequence VALUES('headaches',62);
INSERT INTO sqlite_sequence VALUES('events',17);
CREATE INDEX idx_headaches_timestamp ON headaches(timestamp);
CREATE INDEX idx_headaches_severity ON headaches(severity);
CREATE INDEX idx_headaches_user_id ON headaches(user_id);
CREATE INDEX idx_events_timestamp ON events(timestamp);
CREATE INDEX idx_events_type ON events(event_type);
CREATE INDEX idx_events_user_id ON events(user_id);
CREATE INDEX idx_settings_key ON settings(key);
